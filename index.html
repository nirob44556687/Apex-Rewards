<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EarnX Pro - Ads & Profile</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&family=Hind+Siliguri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #030712;
            --primary: #00d2ff;
            --card: #0f172a;
            --border: rgba(255, 255, 255, 0.1);
            --accent: #00ff88;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', 'Hind Siliguri', sans-serif; }
        body { background: var(--bg); color: #fff; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* হেডার */
        header {
            padding: 15px 20px;
            background: var(--card);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-avatar { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--primary); object-fit: cover; }

        /* মেইন কন্টেন্ট */
        .content { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 100px; }

        /* কার্ডস */
        .balance-box {
            background: linear-gradient(135deg, #1e293b, #030712);
            padding: 25px;
            border-radius: 25px;
            border: 1px solid var(--border);
            text-align: center;
            margin-bottom: 20px;
        }
        .balance-box h1 { font-size: 40px; color: var(--primary); margin: 5px 0; }

        .feature-card {
            background: var(--card);
            border: 1px solid var(--border);
            padding: 15px;
            border-radius: 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
        }
        .icon-box { width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; background: rgba(0,210,255,0.1); color: var(--primary); }

        /* পেজ সিস্টেম */
        .page { display: none; }
        .page.active { display: block; }

        /* নেভিগেশন */
        nav {
            position: fixed; bottom: 15px; left: 15px; right: 15px; height: 70px;
            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px);
            border-radius: 20px; display: flex; justify-content: space-around;
            align-items: center; border: 1px solid var(--border);
        }
        .nav-item { color: #64748b; font-size: 11px; text-align: center; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
        .center-btn { 
            width: 55px; height: 55px; background: var(--primary); 
            border-radius: 18px; color: #000; margin-top: -30px; 
            display: flex; align-items: center; justify-content: center; font-size: 22px; 
            box-shadow: 0 5px 15px rgba(0, 210, 255, 0.3);
        }

        /* ইনপুট */
        input, select { width: 100%; padding: 12px; margin-top: 10px; border-radius: 10px; border: 1px solid var(--border); background: #000; color: #fff; }
        .btn-main { width: 100%; margin-top: 15px; background: var(--primary); padding: 12px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <header>
        <div style="display: flex; align-items: center; gap: 10px;">
            <img id="user-photo" src="https://via.placeholder.com/40" class="user-avatar">
            <div>
                <h4 id="user-name" style="font-size: 14px;">User Name</h4>
                <p id="user-id" style="font-size: 10px; color: #64748b;">ID: 000000</p>
            </div>
        </div>
        <i class="fas fa-wallet" style="color: var(--primary);"></i>
    </header>

    <div class="content">
        <div id="home" class="page active">
            <div class="balance-box">
                <p style="font-size: 13px;">মোট ইনকাম</p>
                <h1 id="balance">0.00</h1>
                <p style="color: var(--accent); font-size: 14px;">Coins: <span id="coins-text">0</span></p>
            </div>

            <div class="feature-card" id="ad-trigger">
                <div class="icon-box"><i class="fas fa-play"></i></div>
                <div><h4>Watch Ads</h4><p style="font-size: 11px; color: #64748b;">প্রতি অ্যাডে ৫০ কয়েন রিওয়ার্ড</p></div>
            </div>

            <div class="feature-card" onclick="changePage('refer')">
                <div class="icon-box" style="color: var(--accent); background: rgba(0,255,136,0.1);"><i class="fas fa-user-plus"></i></div>
                <div><h4>Refer & Earn</h4><p style="font-size: 11px; color: #64748b;">বন্ধুদের ইনভাইট করে আয় করুন</p></div>
            </div>
        </div>

        <div id="wallet" class="page">
            <h3>Withdraw Money</h3>
            <div class="balance-box" style="margin-top: 15px;">
                <p>উত্তোলনযোগ্য ব্যালেন্স</p>
                <h2 id="draw-balance" style="color: var(--accent);">$0.00</h2>
            </div>
            <select id="method">
                <option value="bkash">bKash (বিকাশ)</option>
                <option value="nagad">Nagad (নগদ)</option>
            </select>
            <input type="number" id="phone" placeholder="আপনার বিকাশ/নগদ নাম্বার">
            <input type="number" id="amount" placeholder="কত টাকা তুলতে চান">
            <button class="btn-main" onclick="tg.showAlert('রিকোয়েস্ট সফল হয়েছে! ২৪ ঘন্টার মধ্যে পেমেন্ট পাবেন।')">Withdraw Now</button>
        </div>

        <div id="refer" class="page">
            <h3>Referral System</h3>
            <div style="background: var(--card); padding: 20px; border-radius: 15px; margin-top: 15px; text-align: center;">
                <i class="fas fa-gift" style="font-size: 40px; color: var(--primary); margin-bottom: 10px;"></i>
                <p>আপনার রেফার লিঙ্ক:</p>
                <div id="ref-link" style="background: #000; padding: 10px; margin: 15px 0; border-radius: 8px; font-size: 12px; border: 1px dashed var(--primary);">Loading...</div>
                <button class="btn-main" onclick="copyRef()">Link Copy করুন</button>
            </div>
        </div>

        <div id="profile" class="page">
            <h3>My Profile</h3>
            <div style="text-align: center; padding: 30px; background: var(--card); border-radius: 20px; margin-top: 15px;">
                <img id="prof-img" src="https://via.placeholder.com/100" style="width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--primary);">
                <h2 id="prof-name" style="margin-top: 15px;">Name</h2>
                <p id="prof-id" style="color: #64748b;">ID: 00000000</p>
                <div style="display: flex; justify-content: space-around; margin-top: 20px; border-top: 1px solid var(--border); padding-top: 15px;">
                    <div><h4 id="total-ads">0</h4><p style="font-size: 11px;">Ads Watched</p></div>
                    <div><h4 id="total-ref">0</h4><p style="font-size: 11px;">Referrals</p></div>
                </div>
            </div>
        </div>
    </div>

    <nav>
        <div class="nav-item active" id="n-home" onclick="changePage('home')"><i class="fas fa-home"></i><br>Home</div>
        <div class="nav-item" id="n-wallet" onclick="changePage('wallet')"><i class="fas fa-wallet"></i><br>Wallet</div>
        <div class="center-btn" id="ad-center"><i class="fas fa-play"></i></div>
        <div class="nav-item" id="n-refer" onclick="changePage('refer')"><i class="fas fa-users"></i><br>Refer</div>
        <div class="nav-item" id="n-profile" onclick="changePage('profile')"><i class="fas fa-user-circle"></i><br>Profile</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // ১. Adsgram সেটআপ (ID: 22538)
        const AdController = window.Adsgram.init({ blockId: "22538" });
        let balance = 0.00;
        let coins = 0;
        let adsSeen = 0;

        // ২. ইউজার ডাটা লোড
        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
            const user = tg.initDataUnsafe.user;
            document.getElementById('user-name').innerText = user.first_name;
            document.getElementById('prof-name').innerText = user.first_name + " " + (user.last_name || "");
            document.getElementById('user-id').innerText = "ID: " + user.id;
            document.getElementById('prof-id').innerText = "ID: " + user.id;
            document.getElementById('ref-link').innerText = "https://t.me/YourBotUser?start=" + user.id;
            
            if (user.photo_url) {
                document.getElementById('user-photo').src = user.photo_url;
                document.getElementById('prof-img').src = user.photo_url;
            }
        }

        // ৩. পেজ চেঞ্জ ফাংশন
        function changePage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            if(document.getElementById('n-'+pageId)) document.getElementById('n-'+pageId).classList.add('active');
        }

        // ৪. বিজ্ঞাপন দেখানোর ফাংশন
        async function showAd() {
            try {
                await AdController.show();
                // রিওয়ার্ড লজিক
                coins += 50;
                balance += 0.05;
                adsSeen += 1;
                updateUI();
                tg.showAlert("অভিনন্দন! আপনি ৫০ কয়েন ($0.05) বোনাস পেয়েছেন।");
                tg.HapticFeedback.impactOccurred('medium');
            } catch (e) {
                tg.showAlert("বিজ্ঞাপন লোড হয়নি। আবার চেষ্টা করুন।");
            }
        }

        function updateUI() {
            document.getElementById('balance').innerText = balance.toFixed(2);
            document.getElementById('draw-balance').innerText = "$" + balance.toFixed(2);
            document.getElementById('coins-text').innerText = coins;
            document.getElementById('total-ads').innerText = adsSeen;
        }

        // ইভেন্ট লিসেনার
        document.getElementById('ad-trigger').addEventListener('click', showAd);
        document.getElementById('ad-center').addEventListener('click', showAd);

        function copyRef() {
            const link = document.getElementById('ref-link').innerText;
            navigator.clipboard.writeText(link);
            tg.showAlert("লিঙ্ক কপি করা হয়েছে!");
        }
    </script>
</body>
</html>
